<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تحويل الصوت RVC/So-VITS-SVC</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE',
                    }
                }
            }
        }
    </script>
    <script>
        function checkGPUSupport() {
            try {
                const canvas = document.createElement('canvas');
                const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                gpuAcceleration.useONNX = !!gl;
                return !!gl;
            } catch (e) {
                return false;
            }
        }
    </script>
    <script>
        const hubert = {
            extract(audioData) {
                // Simulate HuBERT feature extraction
                return { features: "extracted_features", success: true };
            }
        };
        
        const rvc = {
            convert(features, settings) {
                // Simulate RVC conversion with GPU acceleration
                return { success: true };
            },
            formantShift(audio, factor) {
                // Simulate formant shifting
                return { success: true };
            },
            noiseReduce(audio) {
                // Simulate noise reduction
                return { success: true };
            },
            compress(audio) {
                // Simulate dynamic range compression
                return { success: true };
            },
            normalize(audio) {
                // Simulate loudness normalization
                return { success: true };
            },
            enhance(audio, level) {
                // Simulate voice enhancement
                console.log(`Enhancing voice (level: ${level})`);
                return { success: true };
            },
            convertToOpus(audio, sampleRate) {
                // Simulate conversion to OPUS at specific sample rate
                console.log(`GPU acceleration ${hasGPU ? 'enabled' : 'disabled'}`);
            }
        };
    </script>
    <style>
        body {
            font-family: 'Tajawal', sans-serif;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        
        .icon-btn:hover {
            transform: scale(1.1);
        }
        
        .icon-btn:active {
            transform: scale(0.95);
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #5D5CDE;
            border-radius: 50%;
            cursor: pointer;
        }
        
        @media (max-width: 640px) {
            .responsive-padding {
                padding: 1rem;
            }
        }
        
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
                if (event.matches) {
                    // Dark mode enabled
                }
            });
        }
    </style>
</head>
<body>
    <h1>تحويل الصوت باستخدام RVC/So-VITS-SVC</h1>
    <p>الصفحة الخاصة بتحويل الصوت عبر تقنيات مختلفة.</p>
</body>
</html>
            originalAudio = file;
            displayFileInfo(file);
            createAudioPreview(file);
            
            // Enable conversion button if both samples are ready
            checkEnableConversion();</script>
<script>        function handleDriveLink() {
            const link = driveLinkInput.value.trim();
            if (!link) {
                alert('الرجاء إدخال رابط صحيح');
                return;</script>
<script>        function displayFileInfo(file) {
            fileName.textContent = file.name;
            fileFormat.textContent = file.type || getExtension(file.name);
            fileSize.textContent = formatFileSize(file.size);</script>
<script>        function createAudioPreview(file) {
            const url = URL.createObjectURL(file);
            originalAudioElement.src = url;
            originalAudioElement.addEventListener('loadedmetadata', () => {
                originalTime.textContent = formatTime(originalAudioElement.duration);
            });
            
            // Cleanup previous URLs
            originalAudioElement.onload = () => {
                URL.revokeObjectURL(url);
            };</script>
<script>        function toggleRecording() {
            if (isRecording) {
                stopRecording();
                recordAudioBtn.innerHTML = '<i class="fas fa-microphone text-xl ml-2"></i><span>تسجيل صوتي</span>';</script>
<script>        async function startRecording() {
            recordedChunks = [];
            try {</script>
<script>                console.error('Error accessing microphone:', err);
                isRecording = false;
                recordAudioBtn.innerHTML = '<i class="fas fa-microphone text-xl ml-2"></i><span>تسجيل صوتي</span>';</script>
<script>        function stopRecording() {
            if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                mediaRecorder.stop();</script>
<script>        function simulateFileSelect() {
            // This is a demo function to simulate file selection when using selectAudioFileBtn</script>
<script>                    console.log("Extracting voice features with HuBERT...");</script>
<script>        function togglePlayOriginal() {
            if (originalAudioElement.paused) {
                originalAudioElement.play();
                playOriginalBtn.innerHTML = '<i class="fas fa-pause ml-2"></i><span>إيقاف</span>';
                
                // Add event to reset button when audio ends
                originalAudioElement.onended = () => {
                    playOriginalBtn.innerHTML = '<i class="fas fa-play ml-2"></i><span>الاستماع قبل التحويل</span>';
                };
            } else {
                originalAudioElement.pause();
                playOriginalBtn.innerHTML = '<i class="fas fa-play ml-2"></i><span>الاستماع قبل التحويل</span>';</script>
<script>        function togglePlayConverted() {
            if (!convertedAudio) return;
            
            if (convertedAudioElement.paused) {
                convertedAudioElement.play();
                playConvertedBtn.innerHTML = '<i class="fas fa-pause ml-2"></i><span>إيقاف</span>';
                
                // Add event to reset button when audio ends
                convertedAudioElement.onended = () => {
                    playConvertedBtn.innerHTML = '<i class="fas fa-play ml-2"></i><span>الاستماع بعد التحويل</span>';
                };
            } else {
                convertedAudioElement.pause();
                playConvertedBtn.innerHTML = '<i class="fas fa-play ml-2"></i><span>الاستماع بعد التحويل</span>';</script>
<script>        function updateConversionDegree() {
            conversionDegreeValue.textContent = conversionDegree.value;
            
            // Update conversion settings based on slider value
            const value = parseInt(conversionDegree.value);
            
            // Calculate normalized values between 0-1 based on slider position
            const normalizedValue = (value - 1) / 29; // 1-30 range normalized to 0-1
            
            // Update settings based on slider
            gpuAcceleration.pitchShiftSteps = Math.round(normalizedValue * 12 - 6); // -6 to +6 semitones
            gpuAcceleration.formantShiftFactor = 0.7 + normalizedValue * 0.6; // 0.7 to 1.3
            gpuAcceleration.enhancementLevel = 0.3 + normalizedValue * 0.7; // 0.3 to 1.0</script>
<script>        function checkEnableConversion() {
         <script>
    async function saveFile(blob) {
        try {
            const handle = await window.showSaveFilePicker();
            const writable = await handle.createWritable();
            await writable.write(blob);
            await writable.close();
        } catch (err) {
            console.error('Failed to save file:', err);
            // Fall back to regular download
            downloadConverted();
        }
    }

    function downloadConverted() {
        // Placeholder for fallback download logic
        console.log("Fallback download triggered");
    }

    // Helper functions
    function formatFileSize(bytes) {
        if (bytes === 0) return '0 Bytes';
        const k = 1024;
        const sizes = ['Bytes', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }

    function formatTime(seconds) {
        seconds = Math.round(seconds);
        const minutes = Math.floor(seconds / 60);
        seconds = seconds % 60;
        return `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
    }

    function getExtension(filename) {
        return filename.split('.').pop().toUpperCase();
    }

    function logProcessingSteps(steps, factor, sampleRate) {
        console.log(`Pitch shifting by ${steps} steps`);
        console.log(`Formant shifting by factor ${factor}`);
        console.log("Applying noise reduction");
        console.log("Applying dynamic compression");
        console.log("Normalizing loudness");
        console.log(`Converting to OPUS format (${sampleRate}Hz)`);
    }

    function simulateConversion() {
        return {
            data: new Uint8Array(10000), // Dummy data
            success: true
        };
    }
</script>
       
       
       
       
<script>                                
